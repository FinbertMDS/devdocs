



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.4, mkdocs-material-2.9.0">
    
    
      
        <title>Develop with Docker - Developer Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.4f4f49e8.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#overview" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Developer Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Developer Documentation
              </span>
              <span class="md-header-nav__topic">
                Develop with Docker
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Developer Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Ubuntu
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Ubuntu
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ubuntu/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ubuntu/command/" title="Command line" class="md-nav__link">
      Command line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ubuntu/ssh/" title="SSH" class="md-nav__link">
      SSH
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Magento
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Magento
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      SSL for Magento site
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        SSL for Magento site
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/ssl/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/ssl/ssl_create/" title="Create SSL" class="md-nav__link">
      Create SSL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/ssl/ssl_magento_setup/" title="Setup SSL for Magento site" class="md-nav__link">
      Setup SSL for Magento site
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/command/" title="Command line" class="md-nav__link">
      Command line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      MFTF
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        MFTF
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/test/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-2" type="checkbox" id="nav-3-5-2">
    
    <label class="md-nav__link" for="nav-3-5-2">
      Functional Testing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-2">
        Functional Testing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/test/functional/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/test/functional/install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/test/functional/run/" title="Test Run" class="md-nav__link">
      Test Run
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/test/functional/create_test_theory/" title="Create a Test - Theory" class="md-nav__link">
      Create a Test - Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/test/functional/create_test_practice/" title="Create a Test - Practice" class="md-nav__link">
      Create a Test - Practice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/test/functional/entities/" title="Functional Testing Framework Entities" class="md-nav__link">
      Functional Testing Framework Entities
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/composer/" title="Install extension Magento by composer" class="md-nav__link">
      Install extension Magento by composer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../magento/note/" title="Note about Magento" class="md-nav__link">
      Note about Magento
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Docker
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Docker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../get-started/" title="Get started" class="md-nav__link">
      Get started
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Develop with Docker
      </label>
    
    <a href="./" title="Develop with Docker" class="md-nav__link md-nav__link--active">
      Develop with Docker
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#docker-development-best-practices" title="Docker development best practices" class="md-nav__link">
    Docker development best practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices-for-writing-dockerfiles" title="Best practices for writing Dockerfiles" class="md-nav__link">
    Best practices for writing Dockerfiles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dockerfile-instructions" title="Dockerfile instructions" class="md-nav__link">
    Dockerfile instructions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../config-network/" title="Configure networking" class="md-nav__link">
      Configure networking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sample/" title="Sample" class="md-nav__link">
      Sample
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../mkdocs/" title="Mkdocs" class="md-nav__link">
      Mkdocs
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#docker-development-best-practices" title="Docker development best practices" class="md-nav__link">
    Docker development best practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices-for-writing-dockerfiles" title="Best practices for writing Dockerfiles" class="md-nav__link">
    Best practices for writing Dockerfiles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dockerfile-instructions" title="Dockerfile instructions" class="md-nav__link">
    Dockerfile instructions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h1>
<p>This is our developer docs about Docker. Our docs includes:</p>
<h2 id="docker-development-best-practices">Docker development best practices<a class="headerlink" href="#docker-development-best-practices" title="Permanent link">&para;</a></h2>
<ul>
<li>How to keep your images small<ul>
<li>Start with an appropriate base image</li>
<li><a href="https://docs.docker.com/engine/userguide/eng-image/multistage-build/">Use multistage builds</a></li>
<li>If you have multiple images with a lot in common, consider creating your own <a href="../base image">https://docs.docker.com/engine/userguide/eng-image/baseimages/</a> with the shared components, and basing your unique images on that</li>
</ul>
</li>
<li>Where and how to persist application data<ul>
<li>Store data using volumes.</li>
</ul>
</li>
<li>Use swarm services when possible</li>
<li>Use CI/CD for testing and deployment</li>
</ul>
<h2 id="best-practices-for-writing-dockerfiles">Best practices for writing Dockerfiles<a class="headerlink" href="#best-practices-for-writing-dockerfiles" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Create ephemeral containers</p>
<p>By "ephemeral" we mean that the container can be stopped and destroyed, then rebuilt and replaced with an absolute minimum set up and configuration.
- Understand build context
- Pipe Dockerfile through stdin</p>
<p>Docker 17.05 and higher (remote build-context)
<div class="codehilite"><pre><span></span>docker build -t foo https://github.com/thajeztah/pgadmin4-docker.git -f-<span class="s">&lt;&lt;EOF</span>
<span class="s">FROM busybox</span>
<span class="s">COPY LICENSE config_local.py /usr/local/lib/python2.7/site-packages/pgadmin4/</span>
<span class="s">EOF</span>
</pre></div>
- Exclude with .dockerignore
- Use multi-stage builds
A Dockerfile for a Go application could look like:
<div class="codehilite"><pre><span></span>FROM golang:1.9.2-alpine3.6 AS build

# Install tools required for project
# Run `docker build --no-cache .` to update dependencies
RUN apk add --no-cache git
RUN go get github.com/golang/dep/cmd/dep

# List project dependencies with Gopkg.toml and Gopkg.lock
# These layers are only re-built when Gopkg files are updated
COPY Gopkg.lock Gopkg.toml /go/src/project/
WORKDIR /go/src/project/
# Install library dependencies
RUN dep ensure -vendor-only

# Copy the entire project and build it
# This layer is rebuilt when a file changes in the project directory
COPY . /go/src/project/
RUN go build -o /bin/project

# This results in a single layer image
FROM scratch
COPY --from=build /bin/project /bin/project
ENTRYPOINT [&quot;/bin/project&quot;]
CMD [&quot;--help&quot;]
</pre></div>
- Don’t install unnecessary packages
- Decouple applications</p>
<ul>
<li>Each container should have only one concern. Decoupling applications into multiple containers makes it easier to scale horizontally and reuse containers. </li>
<li>Use your best judgment to keep containers as clean and modular as possible. If containers depend on each other, you can use <a href="https://docs.docker.com/engine/userguide/networking/">Docker container networks</a> to ensure that these containers can communicate.</li>
<li>Minimize the number of layers</li>
<li>Sort multi-line arguments</li>
</ul>
<p>Adding a space before a backslash () add the end of line to sorting multi-line arguments.
- Leverage build cache</p>
<p>If you do not want to use the cache at all, you can use the --no-cache=true option on the docker build command.</p>
<h2 id="dockerfile-instructions">Dockerfile instructions<a class="headerlink" href="#dockerfile-instructions" title="Permanent link">&para;</a></h2>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#from">FROM</a></p>
<p>Whenever possible, use current official repositories as the basis for your images. We recommend the <a href="https://hub.docker.com/_/alpine/">Alpine image</a> as it is tightly controlled and small in size (currently under 5 MB), while still being a full Linux distribution.</p>
</li>
<li>
<p><a href="https://docs.docker.com/config/labels-custom-metadata/">LABEL</a></p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#run">RUN</a></p>
<ul>
<li>Split long or complex RUN statements on multiple lines separated with backslashes to make your Dockerfile more readable, understandable, and maintainable.</li>
<li>
<p>APT-GET</p>
<p>Using RUN apt-get update &amp;&amp; apt-get install -y ensures your Dockerfile installs the latest package versions with no further coding or manual intervention.
<div class="codehilite"><pre><span></span>RUN apt-get update &amp;&amp; apt-get install -y \
    aufs-tools \
    automake \
    build-essential \
    curl \
    dpkg-sig \
    libcap-dev \
    libsqlite3-dev \
    mercurial \
    reprepro \
    ruby1.9.1 \
    ruby1.9.1-dev \
    s3cmd=1.1.* \
 &amp;&amp; rm -rf /var/lib/apt/lists/*
</pre></div>
    - USING PIPES
Some RUN commands depend on the ability to pipe the output of one command into another, using the pipe character (|)
<div class="codehilite"><pre><span></span>RUN wget -O - https://some.site | wc -l &gt; /number
</pre></div></p>
</li>
</ul>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#cmd">CMD</a></p>
<p>The CMD instruction should be used to run the software contained by your image, along with any arguments. CMD should almost always be used in the form of CMD [“executable”, “param1”, “param2”…].</p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#expose">EXPOSE</a></p>
<p>The EXPOSE instruction indicates the ports on which a container listens for connections. Consequently, you should use the common, traditional port for your application.</p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#env">ENV</a></p>
<p>The ENV instruction is also useful for providing required environment variables specific to services you wish to containerize.</p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#add">ADD or COPY</a></p>
<ul>
<li>COPY only supports the basic copying of local files into the container, while ADD has some features (like local-only tar extraction and remote URL support) that are not immediately obvious.</li>
<li>If you have multiple Dockerfile steps that use different files from your context, COPY them individually, rather than all at once.</li>
</ul>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#entrypoint">ENTRYPOINT</a></p>
<p>The best use for ENTRYPOINT is to set the image’s main command, allowing that image to be run as though it was that command (and then use CMD as the default flags).</p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#volume">VOLUME</a></p>
<p>The VOLUME instruction should be used to expose any database storage area, configuration storage, or files/folders created by your docker container. You are strongly encouraged to use VOLUME for any mutable and/or user-serviceable parts of your image.</p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#user">USER</a></p>
<p>If a service can run without privileges, use USER to change to a non-root user.</p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#workdir">WORKDIR</a></p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#onbuild">ONBUILD</a></p>
</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../get-started/" title="Get started" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Get started
              </span>
            </div>
          </a>
        
        
          <a href="../config-network/" title="Configure networking" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Configure networking
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>